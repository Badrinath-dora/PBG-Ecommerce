

<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- basic -->
      <meta charset="utf-8">
      <meta http-equiv="X-UA-Compatible" content="IE=edge">
      <!-- mobile metas -->
      <meta name="viewport" content="width=device-width, initial-scale=1">
      <meta name="viewport" content="initial-scale=1, maximum-scale=1">
      <!-- site metas -->
      <title>PBG Jewellery</title>
      <meta name="keywords" content="">
      <meta name="description" content="">
      <meta name="author" content="">
      <!-- site icon -->
      <link rel="icon" href="images/fevicon.png" type="image/png" />
      <!-- bootstrap css -->
      <link rel="stylesheet" href="css/bootstrap.min.css" />
      <!-- site css -->
      <link rel="stylesheet" href="style.css" />
      <!-- responsive css -->
      <link rel="stylesheet" href="css/responsive.css" />
      <!-- color css -->
      <link rel="stylesheet" href="css/colors.css" />
      <!-- select bootstrap -->
      <link rel="stylesheet" href="css/bootstrap-select.css" />
      <!-- scrollbar css -->
      <link rel="stylesheet" href="css/perfect-scrollbar.css" />
      <!-- custom css -->
      <link rel="stylesheet" href="css/custom.css" />
      <link rel="stylesheet" href="css/admin.css" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto|Varela+Round" />
      <link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" />
      <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" />
      <link rel="stylesheet" href="https://cdn.datatables.net/1.13.6/css/jquery.dataTables.min.css" />
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>
      <script src="https://cdn.datatables.net/1.13.6/js/jquery.dataTables.min.js"></script>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.4/jquery.min.js"></script>
      <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>

   </head>
   <body class="inner_page tables_page">
    <div class="full_container">
       <div class="inner_container">
          <!-- Sidebar  -->
          <nav id="sidebar">
            <div class="sidebar_blog_1">
                <div class="sidebar-header">
                   <div class="logo_section" style="background-color:aliceblue; height:83px;width:80px">
                      <center>

                    
                      <a href="index.html"><img class="logo_icon img-responsive" style="height:80px;width:80px" src="images/logo.png" alt="#" /></a>
                   </center>
                   </div>
                </div>
                <div class="sidebar_user_info">
                   <div class="icon_setting"></div>
                   <div class="user_profle_side">
                      <div class="user_info">
                         <h6>PBG Jewellery</h6>
                         
                      </div>
                   </div>
                </div>
             </div>
             <div class="sidebar_blog_2">
                <h4>General</h4>
                <ul class="list-unstyled components">
                   <li class="active">
                      <a href="index.html" ><i class="fa fa-dashboard yellow_color"></i> <span>Dashboard</span></a>
          
                   </li>
                  
                   <li><a href="product.html"><i class="fa fa-table purple_color2"></i> <span>Product Management</span></a></li>
                   <li><a href="category.html"><i class="fa fa-bar-chart-o green_color"></i> <span>Category Management</span></a></li>
                   <li><a href="pincode.html"><i class="fa fa-map orange_color2"></i> <span>PinCode Management</span></a></li>
                   <li><a href="images.html"><i class="fa fa-image orange_color2"></i> <span>Image Management</span></a></li>
                   
                   
                 
                </ul>
             </div>
          </nav>
          <!-- end sidebar -->
          <!-- right content -->
          <div id="content">
             <!-- topbar -->
                 <!-- topbar -->
                 <div class="topbar">
                   <nav class="navbar navbar-expand-lg navbar-light">
                      <div class="full">
                         <button type="button" id="sidebarCollapse" class="sidebar_toggle"><i class="fa fa-bars"></i></button>
                         
                         <div class="right_topbar">
                            <div class="icon_info">
                               <button id="logoutBtn" class="btn btn-success" style="margin: 10px;" >
                                  <i class="material-icons">exit_to_app</i> Logout
                                </button>
          
                            </div>
                         </div>
                      </div>
                   </nav>
                </div>

             <br>
               <!-- end topbar -->
               <!-- dashboard inner -->
              

                <div class="table-responsive">
                    <div class="table-wrapper">
                      <div class="table-title">
                        <div class="row">
                          <div class="col-xs-6">
                            <h2>PBG <b>Pincode Management</b></h2>
                          </div>
                          <div class="col-xs-6">
                           
                            <a href="#productFormModal" class="btn btn-success" data-toggle="modal" onclick="resetModalForm()"><i class="material-icons">&#xE147;</i> <span>Add New Pincode</span></a>
                          </div>
                        </div>
                      </div>
            
                      <table id="datatable" class="table table-striped table-hover">
                        <thead>
                          <tr>
                                <th>District Name</th>
                                <th>Office Name</th>
                                <th>State Name</th>
                                <th>Taluk</th>
                                <th>Actions</th>
                          </tr>
                        </thead>
                      </table>
                    </div>
                  </div>
                </div>
                <div id="productFormModal" class="modal fade" role="dialog">
                  <div class="modal-dialog">
                    <div class="modal-content">
                      <form id="add-product-form">
                        <div class="modal-header">
                          <h4 class="modal-title">Add New Pincode</h4>
                          <button type="button" class="close" data-dismiss="modal">&times;</button>
                        </div>
                        <div class="modal-body">
                            <div class="form-group">
                                <label for="districtName">District Name:</label>
                                <input
                                  type="text"
                                  class="form-control"
                                  id="districtName"
                                  required
                                />
                              </div>
                              <div class="form-group">
                                <label for="officeName">Office Name:</label>
                                <input
                                  type="text"
                                  class="form-control"
                                  id="officeName"
                                  required
                                />
                              </div>
                              <div class="form-group">
                                <label for="stateName">State Name:</label>
                                <input
                                  type="text"
                                  class="form-control"
                                  id="stateName"
                                  required
                                />
                              </div>
                              <div class="form-group">
                                <label for="taluk">Taluk:</label>
                                <input type="text" class="form-control" id="taluk" required />
                              </div>
                        </div>
                        <div class="modal-footer">
                          <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel" />
                          <input type="submit" class="btn btn-success" value="Add" />
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
             
            
                <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
                <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-firestore.js"></script>
            
                <script src="config.js"></script>
            
                <script>
                  let table = new DataTable("#datatable");
                  let products = [];
            
                  const productsRef = db.collection('Pincode');
            
                  productsRef.onSnapshot((snapshot) => {
                    table.clear().draw();
            
                    snapshot.forEach((doc) => {
                      var id = doc.id;
                      var product = doc.data();
            
                      products.push({ id: id, ...product });
            
                        var dataSet = [
                        product.districtName ,
                        product.officeName,
                        product.stateName,
                        product.taluk ,
                        `<a href="#productFormModal" class="edit" data-id="${id}" data-toggle="modal" onclick="populateEditForm('${id}')">
                            <i class="material-icons" data-toggle="tooltip" title="Edit">&#xE254;</i>
                        </a>
                        <a href="#" class="delete" data-id="${id}" data-toggle="modal" onclick="deleteProduct('${id}')">
                            <i class="material-icons" data-toggle="tooltip" title="Delete">&#xE872;</i>
                        </a>`,];
                      table.rows.add([dataSet]).draw();
                    });
                  });
            
                  function resetModalForm() {
                    const form = document.getElementById("add-product-form");
                    form.reset();
                    const submitButton = form.querySelector(".btn-success");
                    submitButton.removeAttribute("data-id");
                  }
            
                  const addProductForm = document.getElementById("add-product-form");
                  addProductForm.addEventListener("submit", async function (event) {
                    event.preventDefault();
                    const submitButton = event.target.querySelector(".btn-success");
                    const districtName = document.getElementById("districtName").value;
                    const officeName= document.getElementById("officeName").value;
                    const stateName = document.getElementById("stateName").value;
                    const taluk = document.getElementById("taluk").value;
            
            
                    let data = {
                     
                      districtName: districtName,
                      officeName: officeName,
                      stateName:stateName,
                      taluk: taluk,
                    };
            
                    if (submitButton.hasAttribute("data-id")) {
                      const productKey = submitButton.getAttribute("data-id");
                      await productsRef.doc(productKey).update(data);
                    } else {
                      await productsRef.add(data);
                    }
            
                    $("#productFormModal").modal("hide");
                  });
            
                  function populateEditForm(key) {
                    let index = products.findIndex((e) => e.id == key);
                    if (index != -1) {
                      let product = products[index];
            
                      document.getElementById("districtName").value =product.districtName ;
                    
                   
                     
                      document.getElementById("officeName").value =   product.officeName;
                      document.getElementById("stateName").value =    product.stateName;
                      document.getElementById("taluk").value= product.taluk ;
                    }
            
                    const editSubmitButton = document.querySelector("#productFormModal .btn-success");
                    editSubmitButton.setAttribute("data-id", key);
                  }
            
                  async function deleteProduct(key) {
                    await productsRef.doc(key).delete();
                  }
                </script>
                <script>
                document.addEventListener("DOMContentLoaded", function () {
                  const logoutBtn = document.getElementById("logoutBtn");
            
                  logoutBtn.addEventListener("click", function () {
                    // Clear cookies
                    const cookies = document.cookie.split("; ");
                    for (const cookie of cookies) {
                      const [name, value] = cookie.split("=");
                  document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
                    }
            
                    // Redirect to the login page
                    window.location.href = "login.html"; // Replace with the actual login page URL
                  });
                });
              </script>
          
      </div>
      <!-- jQuery -->
      <script src="js/jquery.min.js"></script>
      <script src="js/popper.min.js"></script>
      <script src="js/bootstrap.min.js"></script>
      <!-- wow animation -->
      <script src="js/animate.js"></script>
      <!-- select country -->
      <script src="js/bootstrap-select.js"></script>
      <!-- owl carousel -->
      <script src="js/owl.carousel.js"></script> 
      <!-- chart js -->
      <script src="js/Chart.min.js"></script>
      <script src="js/Chart.bundle.min.js"></script>
      <script src="js/utils.js"></script>
      <script src="js/analyser.js"></script>
      <!-- nice scrollbar -->
      <script src="js/perfect-scrollbar.min.js"></script>
      <script>
         var ps = new PerfectScrollbar('#sidebar');
      </script>
      <!-- custom js -->
      <script src="js/custom.js"></script>
      <script src="js/chart_custom_style1.js"></script>
   </body>
</html>